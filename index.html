<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tamil Toddler Pro | Emotional Intelligence</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        :root {
            --ios-bg: #F2F2F7;
            --nike-black: #111111;
            --apple-blue: #007AFF;
            --success-green: #34C759;
            --card-shadow: 0 20px 40px rgba(0,0,0,0.1);
            --radius: 32px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0; background-color: var(--ios-bg); color: var(--nike-black);
            height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        /* Parental Gate */
        #parental-gate {
            display: none; position: fixed; inset: 0; background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            z-index: 2000; justify-content: center; align-items: center; flex-direction: column;
        }

        .screen { display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; padding: 20px; }
        .active { display: flex; }

        .progress-header { width: 100%; max-width: 450px; margin-bottom: 15px; }
        .progress-meta { display: flex; justify-content: space-between; font-weight: 700; font-size: 0.9rem; color: #8E8E93; margin-bottom: 5px; }
        .progress-outer { height: 8px; background: #E5E5EA; border-radius: 4px; overflow: hidden; }
        .progress-inner { height: 100%; background: var(--apple-blue); width: 0%; transition: width 0.4s ease; }

        .main-card {
            background: white; width: 100%; max-width: 450px; border-radius: var(--radius);
            overflow: hidden; box-shadow: var(--card-shadow); flex: 1;
            display: flex; flex-direction: column; margin-bottom: 100px;
        }

        .img-container { width: 100%; height: 55%; background: #E5E5EA; position: relative; }
        .main-img { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.3s; }

        .content { padding: 20px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .tam-txt { font-size: 2.8rem; font-weight: 900; margin: 10px 0; }
        
        .play-bar {
            background: var(--success-green); color: white; padding: 18px; border-radius: 20px;
            display: flex; align-items: center; justify-content: center; gap: 12px;
            font-size: 1.2rem; font-weight: 800; cursor: pointer;
        }

        .next-btn {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: var(--nike-black); color: white; padding: 20px;
            border-radius: 50px; font-size: 1.2rem; font-weight: 800; width: 90%; max-width: 400px; border: none;
        }

        #celebration {
            display: none; position: fixed; inset: 0; background: white; z-index: 1000;
            flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }

        .cat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 500px; }
        .cat-btn { background: white; padding: 25px; border-radius: 24px; box-shadow: var(--card-shadow); font-weight: 700; text-align: center; cursor: pointer; }
    </style>
</head>
<body>

    <div id="parental-gate">
        <h2 id="gate-q"></h2>
        <div id="gate-opts"></div>
    </div>

    <div id="home-screen" class="screen active">
        <h1 style="margin-top:40px; font-weight: 900;">LEARN TAMIL</h1>
        <div class="cat-grid">
            <div class="cat-btn" onclick="start('fruits')">üçì<br>Fruits</div>
            <div class="cat-btn" onclick="start('animals')">ü¶Å<br>Animals</div>
            <div class="cat-btn" onclick="start('moods')">üòä<br>Moods</div>
            <div class="cat-btn" onclick="start('actions')">‚ö°<br>Actions</div>
        </div>
    </div>

    <div id="app-screen" class="screen">
        <div class="progress-header">
            <div class="progress-meta">
                <span onclick="openGate()" style="cursor:pointer">üè† Home</span>
                <span id="prog-label"></span>
            </div>
            <div class="progress-outer"><div id="prog-bar" class="progress-inner"></div></div>
        </div>

        <div class="main-card">
            <div class="img-container">
                <img id="m-img" class="main-img" onerror="handleImageError(this)">
            </div>
            <div class="content">
                <div id="m-eng" style="color:#8E8E93; font-weight:700; letter-spacing:1px"></div>
                <div id="m-tam" class="tam-txt"></div>
                <div class="play-bar" onclick="speak()">
                    <span id="v-icon">‚ñ∂</span> <span id="v-label">LISTEN</span>
                </div>
            </div>
        </div>
        <button class="next-btn" onclick="next()">CONTINUE</button>
    </div>

    <div id="celebration">
        <span style="font-size: 5rem;">üèÜ</span>
        <h1 style="font-size: 3rem; margin: 10px 0;">Great Job!</h1>
        <button class="next-btn" style="position:static" onclick="location.reload()">PLAY AGAIN</button>
    </div>

    <script>
        const synth = window.speechSynthesis;
        const db = {
            fruits: [
                {e:"Apple", t:"‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç", i:"https://images.unsplash.com/photo-1560806887-1e4cd0b6bccb?w=600", alt:"https://images.pexels.com/photos/102104/pexels-photo-102104.jpeg?w=600"},
                {e:"Mango", t:"‡ÆÆ‡Ææ‡ÆÆ‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1591073113125-e46713c829ed?w=600", alt:"https://images.pexels.com/photos/2294471/pexels-photo-2294471.jpeg?w=600"},
                {e:"Banana", t:"‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1528825871115-3581a5387919?w=600", alt:"https://images.pexels.com/photos/2870882/pexels-photo-2870882.jpeg?w=600"},
                {e:"Grapes", t:"‡Æ§‡Æø‡Æ∞‡Ææ‡Æü‡Øç‡Æö‡Øà", i:"https://images.unsplash.com/photo-1537640538966-79f369143f8f?w=600", alt:"https://images.pexels.com/photos/708777/pexels-photo-708777.jpeg?w=600"},
                {e:"Orange", t:"‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ", i:"https://images.unsplash.com/photo-1582979512210-99b6a53386f9?w=600", alt:"https://images.pexels.com/photos/161559/orange-fruit-vitamins-healthy-eating-161559.jpeg?w=600"},
                {e:"Pineapple", t:"‡ÆÖ‡Æ©‡Øç‡Æ©‡Ææ‡Æö‡Æø", i:"https://images.unsplash.com/photo-1550258114-68bd299738ad?w=600", alt:"https://images.pexels.com/photos/947885/pexels-photo-947885.jpeg?w=600"},
                {e:"Watermelon", t:"‡Æ§‡Æ∞‡Øç‡Æ™‡ØÇ‡Æö‡Æ£‡Æø", i:"https://images.unsplash.com/photo-1587049352846-4a222e784d38?w=600", alt:"https://images.pexels.com/photos/1313267/pexels-photo-1313267.jpeg?w=600"},
                {e:"Strawberry", t:"‡Æ∏‡Øç‡Æü‡Øç‡Æ∞‡Ææ‡Æ™‡ØÜ‡Æ∞‡Æø", i:"https://images.unsplash.com/photo-1464965911861-746a04b4bca6?w=600", alt:"https://images.pexels.com/photos/93405/pexels-photo-93405.jpeg?w=600"},
                {e:"Raspberry", t:"‡Æ∞‡Ææ‡Æ∏‡Øç‡Æ™‡ØÜ‡Æ∞‡Øç‡Æ∞‡Æø", i:"https://images.unsplash.com/photo-1534073828943-f801091bb18c?w=600", alt:"https://images.pexels.com/photos/59945/strawberry-fruit-berry-red-59945.jpeg?w=600"},
                {e:"Blueberry", t:"‡Æ™‡Øç‡Æ≥‡ØÇ‡Æ™‡ØÜ‡Æ∞‡Øç‡Æ∞‡Æø", i:"https://images.unsplash.com/photo-1498557850523-fd3d118b962e?w=600", alt:"https://images.pexels.com/photos/1128678/pexels-photo-1128678.jpeg?w=600"}
            ],
            moods: [
                {e:"Happy", t:"‡ÆÆ‡Æï‡Æø‡Æ¥‡Øç‡Æö‡Øç‡Æö‡Æø", i:"https://images.unsplash.com/photo-1502541229470-761741e7360b?w=600", alt:"https://images.pexels.com/photos/35537/child-children-girl-sad.jpg?w=600"},
                {e:"Sad", t:"‡Æµ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1471286174890-9c112ffca5b4?w=600", alt:"https://images.pexels.com/photos/1162461/pexels-photo-1162461.jpeg?w=600"},
                {e:"Excited", t:"‡Æ™‡Æ∞‡Æµ‡Æö‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1519238263530-99bdd11df2ea?w=600", alt:"https://images.pexels.com/photos/1493111/pexels-photo-1493111.jpeg?w=600"},
                {e:"Angry", t:"‡Æï‡Øã‡Æ™‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1577467261905-64582f34f783?w=600", alt:"https://images.pexels.com/photos/3806742/pexels-photo-3806742.jpeg?w=600"},
                {e:"Scared", t:"‡Æ™‡ÆØ‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1542034176-599a0a4c07d3?w=600", alt:"https://images.pexels.com/photos/6320092/pexels-photo-6320092.jpeg?w=600"},
                {e:"Tired", t:"‡Æö‡Øã‡Æ∞‡Øç‡Æµ‡ØÅ", i:"https://images.unsplash.com/photo-1511289081-d06dba19bfbd?w=600", alt:"https://images.pexels.com/photos/3845492/pexels-photo-3845492.jpeg?w=600"},
                {e:"Surprised", t:"‡ÆÜ‡Æö‡Øç‡Æö‡Æ∞‡Æø‡ÆØ‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1481824429379-07aa5e5b0739?w=600", alt:"https://images.pexels.com/photos/6321285/pexels-photo-6321285.jpeg?w=600"},
                {e:"Love", t:"‡ÆÖ‡Æ©‡Øç‡Æ™‡ØÅ", i:"https://images.unsplash.com/photo-1516627145497-ae6968895b74?w=600", alt:"https://images.pexels.com/photos/161551/child-mother-daughter-love-161551.jpeg?w=600"},
                {e:"Proud", t:"‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Æø‡Æ§‡ÆÆ‡Øç", i:"https://images.unsplash.com/photo-1544717297-fa95b8ee4a31?w=600", alt:"https://images.pexels.com/photos/3933221/pexels-photo-3933221.jpeg?w=600"},
                {e:"Silly", t:"‡Æï‡Øá‡Æ≤‡Æø", i:"https://images.unsplash.com/photo-1530652101053-8c0db4fbb5de?w=600", alt:"https://images.pexels.com/photos/3662804/pexels-photo-3662804.jpeg?w=600"}
            ],
            animals: [ /* ... keeping from previous update ... */ ],
            actions: [ /* ... keeping from previous update ... */ ]
        };

        let set = [], idx = 0;

        function handleImageError(img) {
            const item = set[idx];
            if (img.src !== item.alt) { img.src = item.alt; } 
            else { img.src = `https://ui-avatars.com/api/?name=${item.e}&background=random&size=512`; }
        }

        function start(c) {
            set = db[c]; idx = 0;
            document.getElementById('home-screen').classList.remove('active');
            document.getElementById('app-screen').classList.add('active');
            update();
        }

        function update() {
            const item = set[idx];
            const img = document.getElementById('m-img');
            img.style.opacity = 0;
            img.src = item.i;
            img.onload = () => img.style.opacity = 1;
            
            document.getElementById('m-eng').innerText = item.e.toUpperCase();
            document.getElementById('m-tam').innerText = item.t;
            
            const p = ((idx + 1) / set.length) * 100;
            document.getElementById('prog-bar').style.width = p + '%';
            document.getElementById('prog-label').innerText = `${idx + 1} / ${set.length}`;
            reset();
        }

        function speak() {
            if(synth.speaking) { synth.cancel(); reset(); return; }
            const u = new SpeechSynthesisUtterance(set[idx].t);
            u.lang = 'ta-IN';
            const v = synth.getVoices().find(v => v.lang.includes('ta'));
            if(v) u.voice = v;
            u.onstart = () => { document.getElementById('v-icon').innerText = "‚è∏"; document.getElementById('v-label').innerText = "PAUSE"; };
            u.onend = reset;
            synth.speak(u);
        }

        function reset() { document.getElementById('v-icon').innerText = "‚ñ∂"; document.getElementById('v-label').innerText = "LISTEN"; }

        function next() {
            if(idx < set.length - 1) { idx++; update(); }
            else { document.getElementById('celebration').style.display = 'flex'; }
        }

        function openGate() {
            const n1 = Math.floor(Math.random()*5)+1, n2 = Math.floor(Math.random()*5)+1, ans = n1+n2;
            document.getElementById('gate-q').innerText = `Parents: ${n1} + ${n2} = ?`;
            const o = document.getElementById('gate-opts'); o.innerHTML = '';
            [ans, ans+1, ans+2].sort(()=>Math.random()-0.5).forEach(n => {
                const b = document.createElement('button');
                b.style.cssText = "padding:15px 30px; margin:10px; border-radius:12px; border:none; background:var(--apple-blue); color:white; font-weight:700;";
                b.innerText = n;
                b.onclick = () => n === ans ? location.reload() : alert("Try again!");
                o.appendChild(b);
            });
            document.getElementById('parental-gate').style.display = 'flex';
        }
    </script>
</body>
</html>
